{"id":"Q0UK","dependencies":[{"name":"/Users/evinsellin/code/homepage/.babelrc","includedInParent":true,"mtime":1618113312087},{"name":"/Users/evinsellin/code/homepage/package.json","includedInParent":true,"mtime":1618121380722}],"generated":{"js":"function n(n,s){if(!(n instanceof s))throw new TypeError(\"Cannot call a class as a function\")}function s(n,s){for(var e=0;e<s.length;e++){var t=s[e];t.enumerable=t.enumerable||!1,t.configurable=!0,\"value\"in t&&(t.writable=!0),Object.defineProperty(n,t.key,t)}}function e(n,e,t){return e&&s(n.prototype,e),t&&s(n,t),n}var t=function(n){return\"\\n<!DOCTYPE html>\\n<html>\\n  <head>\\n    <script>\\n      function runScript(source, syscalls, args, env){\\n        eval(source);\\n      };\\n\\n      (function(){\\n        let scriptContents = null;\\n        let id = 30000;\\n        let syscalls;\\n\\n        const syscallCBs = {};\\n\\n        function makeSyscall(name, arg, cb){\\n          syscallCBs[id] = cb;\\n          post({type: 'syscall', name, arg, id });\\n          id++;\\n        }\\n\\n        function handleSyscallResponse(id, args){\\n          try {\\n            syscallCBs[id] && syscallCBs[id](...args);\\n          } catch (e) {\\n            syscalls.write({ fd: 2, data: e.message + '\\\\n' });\\n            syscalls.terminate(1);\\n          }\\n        }\\n\\n        function syscallsFromNames(syscallNames){\\n          return syscallNames.reduce((acc, name) => {\\n            acc[name] = (arg, cb) => makeSyscall(name, arg, cb)\\n            return acc;\\n          }, {});\\n        }\\n\\n        function loadScript(source, syscallNames, args, env){\\n          syscalls = syscallsFromNames(syscallNames);\\n          try {\\n            runScript(source, syscalls, args, env);\\n          } catch (e) {\\n            syscalls.write({ fd: 2, data: e.message + '\\\\n' });\\n            syscalls.terminate(1);\\n          }\\n        }\\n\\n        function receiveMessage(msg){\\n          switch(msg.type){\\n            case 'script':\\n              loadScript(msg.source, msg.syscallNames, msg.args, msg.env);\\n              break;\\n            case 'syscallResponse':\\n              handleSyscallResponse(msg.id, msg.args)\\n              break;\\n          }\\n        }\\n\\n        function post(msg){\\n          window.parent.postMessage(JSON.stringify({ msg, iframeId: \".concat(JSON.stringify(n),\"}), '*');\\n        }\\n\\n        function listen(fn) {\\n          const recv = evt => fn(JSON.parse(evt.data));\\n          window.addEventListener(\\\"message\\\", recv, false);\\n        }\\n\\n        document.addEventListener('DOMContentLoaded', () => {\\n          listen(receiveMessage);\\n          post({ type: 'ready' });\\n        });\\n      })();\\n\\n    <\\/script>\\n  </head>\\n</html>\\n\")},a=2e3,i=function(n){return\"data:text/html;base64,\"+btoa(n)},c=function(){function s(e,c,r,l){n(this,s),this.source=e,this.syscalls=c,this.args=r,this.env=l,this.iframeId=a,a++;var o=document.createElement(\"iframe\");this.iframe=o,document.body.appendChild(o),o.sandbox=\"allow-scripts\",o.src=i(t(this.iframeId)),this.listeners=[],this.listen(this.handleEvent.bind(this))}return e(s,[{key:\"post\",value:function(n){this.iframe.contentWindow.postMessage(JSON.stringify(n),\"*\")}},{key:\"listen\",value:function(n){var s=this,e=function(e){if(e.source===s.iframe.contentWindow){var t=JSON.parse(e.data).msg;n(t)}};window.addEventListener(\"message\",e,!1),this.listeners.push(e)}},{key:\"handleEvent\",value:function(n){var s=this;switch(n.type){case\"ready\":this.post({type:\"script\",source:this.source,syscallNames:Object.keys(this.syscalls),args:this.args,env:this.env});break;case\"syscall\":this.syscalls[n.name](n.arg,function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];s.post({type:\"syscallResponse\",id:n.id,args:t})}),\"terminate\"===n.name&&this.cleanup()}}},{key:\"cleanup\",value:function(){document.body.removeChild(this.iframe),this.listeners.forEach(function(n){return window.removeEventListener(\"message\",n)}),this.listeners=[]}}]),s}();window.runInSandbox=function(n,s,e,t){new c(n,s,e,t)};"},"sourceMaps":{"js":{"mappings":[{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":0}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":9}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":11}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":13}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":16}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":21}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":34}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":37}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":43}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":47}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":57}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":94}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":103}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":105}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":107}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":110}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":114}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":118}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":120}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":122}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":124}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":126}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":133}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":137}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":138}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":142}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":144}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":146}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":149}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":151}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":162}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":164}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":177}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":179}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":181}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":195}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":197}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":207}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":211}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":213}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":223}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":226}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":233}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":248}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":250}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":252}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":256}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":260}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":269}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":271}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":273}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":275}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":278}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":285}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":288}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":290}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":292}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":302}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":305}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":308}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":310}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":312}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":315}},{"source":"sandbox.js","original":{"line":29,"column":0},"generated":{"line":1,"column":317}},{"source":"sandbox.js","name":"sandboxText","original":{"line":29,"column":6},"generated":{"line":1,"column":321}},{"source":"sandbox.js","original":{"line":29,"column":20},"generated":{"line":1,"column":323}},{"source":"sandbox.js","name":"iframeId","original":{"line":29,"column":20},"generated":{"line":1,"column":332}},{"source":"sandbox.js","name":"JSON","original":{"line":89,"column":70},"generated":{"line":1,"column":335}},{"source":"sandbox.js","name":"JSON","original":{"line":89,"column":70},"generated":{"line":1,"column":341}},{"source":"sandbox.js","name":"JSON","original":{"line":89,"column":70},"generated":{"line":1,"column":2061}},{"source":"sandbox.js","name":"JSON","original":{"line":89,"column":70},"generated":{"line":1,"column":2068}},{"source":"sandbox.js","name":"stringify","original":{"line":89,"column":75},"generated":{"line":1,"column":2073}},{"source":"sandbox.js","name":"iframeId","original":{"line":89,"column":85},"generated":{"line":1,"column":2083}},{"source":"sandbox.js","original":{"line":29,"column":28},"generated":{"line":1,"column":2086}},{"source":"sandbox.js","name":"iframeId","original":{"line":108,"column":4},"generated":{"line":1,"column":2476}},{"source":"sandbox.js","original":{"line":108,"column":15},"generated":{"line":1,"column":2478}},{"source":"sandbox.js","name":"dataUrl","original":{"line":110,"column":6},"generated":{"line":1,"column":2482}},{"source":"sandbox.js","original":{"line":110,"column":16},"generated":{"line":1,"column":2484}},{"source":"sandbox.js","name":"data","original":{"line":110,"column":16},"generated":{"line":1,"column":2493}},{"source":"sandbox.js","original":{"line":110,"column":24},"generated":{"line":1,"column":2496}},{"source":"sandbox.js","original":{"line":110,"column":24},"generated":{"line":1,"column":2502}},{"source":"sandbox.js","name":"btoa","original":{"line":110,"column":51},"generated":{"line":1,"column":2527}},{"source":"sandbox.js","name":"data","original":{"line":110,"column":56},"generated":{"line":1,"column":2532}},{"source":"sandbox.js","name":"ProcessSandbox","original":{"line":112,"column":6},"generated":{"line":1,"column":2536}},{"source":"sandbox.js","name":"ProcessSandbox","original":{"line":112,"column":6},"generated":{"line":1,"column":2538}},{"source":"sandbox.js","name":"source","original":{"line":113,"column":14},"generated":{"line":1,"column":2549}},{"source":"sandbox.js","name":"source","original":{"line":113,"column":14},"generated":{"line":1,"column":2558}},{"source":"sandbox.js","name":"source","original":{"line":113,"column":14},"generated":{"line":1,"column":2560}},{"source":"sandbox.js","name":"syscalls","original":{"line":113,"column":22},"generated":{"line":1,"column":2562}},{"source":"sandbox.js","name":"args","original":{"line":113,"column":32},"generated":{"line":1,"column":2564}},{"source":"sandbox.js","name":"env","original":{"line":113,"column":38},"generated":{"line":1,"column":2566}},{"source":"sandbox.js","original":{"line":113,"column":42},"generated":{"line":1,"column":2569}},{"source":"sandbox.js","original":{"line":113,"column":42},"generated":{"line":1,"column":2571}},{"source":"sandbox.js","original":{"line":113,"column":42},"generated":{"line":1,"column":2576}},{"source":"sandbox.js","name":"source","original":{"line":114,"column":9},"generated":{"line":1,"column":2579}},{"source":"sandbox.js","name":"source","original":{"line":114,"column":9},"generated":{"line":1,"column":2584}},{"source":"sandbox.js","name":"source","original":{"line":114,"column":18},"generated":{"line":1,"column":2591}},{"source":"sandbox.js","name":"syscalls","original":{"line":115,"column":9},"generated":{"line":1,"column":2593}},{"source":"sandbox.js","name":"syscalls","original":{"line":115,"column":9},"generated":{"line":1,"column":2598}},{"source":"sandbox.js","name":"syscalls","original":{"line":115,"column":20},"generated":{"line":1,"column":2607}},{"source":"sandbox.js","name":"args","original":{"line":116,"column":9},"generated":{"line":1,"column":2609}},{"source":"sandbox.js","name":"args","original":{"line":116,"column":9},"generated":{"line":1,"column":2614}},{"source":"sandbox.js","name":"args","original":{"line":116,"column":16},"generated":{"line":1,"column":2619}},{"source":"sandbox.js","name":"env","original":{"line":117,"column":9},"generated":{"line":1,"column":2621}},{"source":"sandbox.js","name":"env","original":{"line":117,"column":9},"generated":{"line":1,"column":2626}},{"source":"sandbox.js","name":"env","original":{"line":117,"column":15},"generated":{"line":1,"column":2630}},{"source":"sandbox.js","name":"iframeId","original":{"line":120,"column":9},"generated":{"line":1,"column":2632}},{"source":"sandbox.js","name":"iframeId","original":{"line":120,"column":9},"generated":{"line":1,"column":2637}},{"source":"sandbox.js","name":"iframeId","original":{"line":120,"column":20},"generated":{"line":1,"column":2646}},{"source":"sandbox.js","name":"iframeId","original":{"line":121,"column":4},"generated":{"line":1,"column":2648}},{"source":"sandbox.js","name":"iframe","original":{"line":124,"column":10},"generated":{"line":1,"column":2652}},{"source":"sandbox.js","name":"iframe","original":{"line":124,"column":10},"generated":{"line":1,"column":2656}},{"source":"sandbox.js","name":"document","original":{"line":124,"column":19},"generated":{"line":1,"column":2658}},{"source":"sandbox.js","name":"createElement","original":{"line":124,"column":28},"generated":{"line":1,"column":2667}},{"source":"sandbox.js","original":{"line":124,"column":42},"generated":{"line":1,"column":2681}},{"source":"sandbox.js","name":"iframe","original":{"line":125,"column":9},"generated":{"line":1,"column":2691}},{"source":"sandbox.js","name":"iframe","original":{"line":125,"column":9},"generated":{"line":1,"column":2696}},{"source":"sandbox.js","name":"iframe","original":{"line":125,"column":18},"generated":{"line":1,"column":2703}},{"source":"sandbox.js","name":"document","original":{"line":127,"column":4},"generated":{"line":1,"column":2705}},{"source":"sandbox.js","name":"body","original":{"line":127,"column":13},"generated":{"line":1,"column":2714}},{"source":"sandbox.js","name":"appendChild","original":{"line":127,"column":18},"generated":{"line":1,"column":2719}},{"source":"sandbox.js","name":"iframe","original":{"line":127,"column":30},"generated":{"line":1,"column":2731}},{"source":"sandbox.js","name":"iframe","original":{"line":128,"column":4},"generated":{"line":1,"column":2734}},{"source":"sandbox.js","name":"sandbox","original":{"line":128,"column":11},"generated":{"line":1,"column":2736}},{"source":"sandbox.js","original":{"line":128,"column":21},"generated":{"line":1,"column":2744}},{"source":"sandbox.js","name":"iframe","original":{"line":129,"column":4},"generated":{"line":1,"column":2760}},{"source":"sandbox.js","name":"src","original":{"line":129,"column":11},"generated":{"line":1,"column":2762}},{"source":"sandbox.js","name":"dataUrl","original":{"line":129,"column":17},"generated":{"line":1,"column":2766}},{"source":"sandbox.js","name":"sandboxText","original":{"line":129,"column":25},"generated":{"line":1,"column":2768}},{"source":"sandbox.js","original":{"line":129,"column":37},"generated":{"line":1,"column":2770}},{"source":"sandbox.js","name":"iframeId","original":{"line":129,"column":42},"generated":{"line":1,"column":2775}},{"source":"sandbox.js","name":"listeners","original":{"line":130,"column":9},"generated":{"line":1,"column":2786}},{"source":"sandbox.js","name":"listeners","original":{"line":130,"column":9},"generated":{"line":1,"column":2791}},{"source":"sandbox.js","original":{"line":130,"column":21},"generated":{"line":1,"column":2801}},{"source":"sandbox.js","name":"listen","original":{"line":131,"column":9},"generated":{"line":1,"column":2804}},{"source":"sandbox.js","name":"listen","original":{"line":131,"column":9},"generated":{"line":1,"column":2809}},{"source":"sandbox.js","original":{"line":131,"column":16},"generated":{"line":1,"column":2816}},{"source":"sandbox.js","name":"handleEvent","original":{"line":131,"column":21},"generated":{"line":1,"column":2821}},{"source":"sandbox.js","name":"bind","original":{"line":131,"column":33},"generated":{"line":1,"column":2833}},{"source":"sandbox.js","original":{"line":131,"column":38},"generated":{"line":1,"column":2838}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2845}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2852}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2854}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2856}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2857}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2858}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2862}},{"source":"sandbox.js","original":{"line":134,"column":2},"generated":{"line":1,"column":2869}},{"source":"sandbox.js","original":{"line":134,"column":2},"generated":{"line":1,"column":2875}},{"source":"sandbox.js","name":"msg","original":{"line":134,"column":7},"generated":{"line":1,"column":2884}},{"source":"sandbox.js","name":"iframe","original":{"line":135,"column":9},"generated":{"line":1,"column":2887}},{"source":"sandbox.js","name":"iframe","original":{"line":135,"column":9},"generated":{"line":1,"column":2892}},{"source":"sandbox.js","name":"contentWindow","original":{"line":135,"column":16},"generated":{"line":1,"column":2899}},{"source":"sandbox.js","name":"postMessage","original":{"line":135,"column":30},"generated":{"line":1,"column":2913}},{"source":"sandbox.js","name":"JSON","original":{"line":135,"column":42},"generated":{"line":1,"column":2925}},{"source":"sandbox.js","name":"stringify","original":{"line":135,"column":47},"generated":{"line":1,"column":2930}},{"source":"sandbox.js","name":"msg","original":{"line":135,"column":57},"generated":{"line":1,"column":2940}},{"source":"sandbox.js","original":{"line":135,"column":63},"generated":{"line":1,"column":2943}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2950}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2951}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":2955}},{"source":"sandbox.js","original":{"line":138,"column":2},"generated":{"line":1,"column":2964}},{"source":"sandbox.js","original":{"line":138,"column":2},"generated":{"line":1,"column":2970}},{"source":"sandbox.js","name":"fn","original":{"line":138,"column":9},"generated":{"line":1,"column":2979}},{"source":"sandbox.js","original":{"line":138,"column":13},"generated":{"line":1,"column":2982}},{"source":"sandbox.js","original":{"line":138,"column":13},"generated":{"line":1,"column":2986}},{"source":"sandbox.js","original":{"line":138,"column":13},"generated":{"line":1,"column":2988}},{"source":"sandbox.js","name":"recv","original":{"line":139,"column":10},"generated":{"line":1,"column":2993}},{"source":"sandbox.js","original":{"line":139,"column":17},"generated":{"line":1,"column":2995}},{"source":"sandbox.js","name":"evt","original":{"line":139,"column":17},"generated":{"line":1,"column":3004}},{"source":"sandbox.js","name":"evt","original":{"line":140,"column":9},"generated":{"line":1,"column":3007}},{"source":"sandbox.js","name":"evt","original":{"line":140,"column":9},"generated":{"line":1,"column":3010}},{"source":"sandbox.js","name":"source","original":{"line":140,"column":13},"generated":{"line":1,"column":3012}},{"source":"sandbox.js","original":{"line":140,"column":24},"generated":{"line":1,"column":3021}},{"source":"sandbox.js","name":"iframe","original":{"line":140,"column":29},"generated":{"line":1,"column":3023}},{"source":"sandbox.js","name":"contentWindow","original":{"line":140,"column":36},"generated":{"line":1,"column":3030}},{"source":"sandbox.js","original":{"line":140,"column":51},"generated":{"line":1,"column":3044}},{"source":"sandbox.js","name":"JSON","original":{"line":141,"column":24},"generated":{"line":1,"column":3045}},{"source":"sandbox.js","name":"msg","original":{"line":141,"column":16},"generated":{"line":1,"column":3049}},{"source":"sandbox.js","name":"JSON","original":{"line":141,"column":24},"generated":{"line":1,"column":3051}},{"source":"sandbox.js","name":"parse","original":{"line":141,"column":29},"generated":{"line":1,"column":3056}},{"source":"sandbox.js","name":"evt","original":{"line":141,"column":35},"generated":{"line":1,"column":3062}},{"source":"sandbox.js","name":"data","original":{"line":141,"column":39},"generated":{"line":1,"column":3064}},{"source":"sandbox.js","name":"msg","original":{"line":141,"column":16},"generated":{"line":1,"column":3070}},{"source":"sandbox.js","name":"fn","original":{"line":142,"column":8},"generated":{"line":1,"column":3074}},{"source":"sandbox.js","name":"msg","original":{"line":142,"column":11},"generated":{"line":1,"column":3076}},{"source":"sandbox.js","name":"window","original":{"line":145,"column":4},"generated":{"line":1,"column":3081}},{"source":"sandbox.js","name":"addEventListener","original":{"line":145,"column":11},"generated":{"line":1,"column":3088}},{"source":"sandbox.js","original":{"line":145,"column":28},"generated":{"line":1,"column":3105}},{"source":"sandbox.js","name":"recv","original":{"line":145,"column":39},"generated":{"line":1,"column":3115}},{"source":"sandbox.js","original":{"line":145,"column":45},"generated":{"line":1,"column":3118}},{"source":"sandbox.js","name":"listeners","original":{"line":146,"column":9},"generated":{"line":1,"column":3121}},{"source":"sandbox.js","name":"listeners","original":{"line":146,"column":9},"generated":{"line":1,"column":3126}},{"source":"sandbox.js","name":"push","original":{"line":146,"column":19},"generated":{"line":1,"column":3136}},{"source":"sandbox.js","name":"recv","original":{"line":146,"column":24},"generated":{"line":1,"column":3141}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3146}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3147}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3151}},{"source":"sandbox.js","original":{"line":149,"column":2},"generated":{"line":1,"column":3165}},{"source":"sandbox.js","original":{"line":149,"column":2},"generated":{"line":1,"column":3171}},{"source":"sandbox.js","name":"evt","original":{"line":149,"column":14},"generated":{"line":1,"column":3180}},{"source":"sandbox.js","original":{"line":149,"column":18},"generated":{"line":1,"column":3183}},{"source":"sandbox.js","original":{"line":149,"column":18},"generated":{"line":1,"column":3187}},{"source":"sandbox.js","original":{"line":149,"column":18},"generated":{"line":1,"column":3189}},{"source":"sandbox.js","name":"evt","original":{"line":150,"column":11},"generated":{"line":1,"column":3194}},{"source":"sandbox.js","name":"evt","original":{"line":150,"column":11},"generated":{"line":1,"column":3201}},{"source":"sandbox.js","name":"type","original":{"line":150,"column":15},"generated":{"line":1,"column":3203}},{"source":"sandbox.js","original":{"line":151,"column":11},"generated":{"line":1,"column":3209}},{"source":"sandbox.js","original":{"line":151,"column":11},"generated":{"line":1,"column":3213}},{"source":"sandbox.js","name":"post","original":{"line":152,"column":13},"generated":{"line":1,"column":3221}},{"source":"sandbox.js","name":"post","original":{"line":152,"column":13},"generated":{"line":1,"column":3226}},{"source":"sandbox.js","original":{"line":152,"column":18},"generated":{"line":1,"column":3231}},{"source":"sandbox.js","name":"type","original":{"line":153,"column":10},"generated":{"line":1,"column":3232}},{"source":"sandbox.js","original":{"line":153,"column":16},"generated":{"line":1,"column":3237}},{"source":"sandbox.js","name":"source","original":{"line":154,"column":10},"generated":{"line":1,"column":3246}},{"source":"sandbox.js","original":{"line":154,"column":18},"generated":{"line":1,"column":3253}},{"source":"sandbox.js","name":"source","original":{"line":154,"column":23},"generated":{"line":1,"column":3258}},{"source":"sandbox.js","name":"syscallNames","original":{"line":155,"column":10},"generated":{"line":1,"column":3265}},{"source":"sandbox.js","name":"Object","original":{"line":155,"column":24},"generated":{"line":1,"column":3278}},{"source":"sandbox.js","name":"keys","original":{"line":155,"column":31},"generated":{"line":1,"column":3285}},{"source":"sandbox.js","original":{"line":155,"column":36},"generated":{"line":1,"column":3290}},{"source":"sandbox.js","name":"syscalls","original":{"line":155,"column":41},"generated":{"line":1,"column":3295}},{"source":"sandbox.js","name":"args","original":{"line":156,"column":10},"generated":{"line":1,"column":3305}},{"source":"sandbox.js","original":{"line":156,"column":16},"generated":{"line":1,"column":3310}},{"source":"sandbox.js","name":"args","original":{"line":156,"column":21},"generated":{"line":1,"column":3315}},{"source":"sandbox.js","name":"env","original":{"line":157,"column":10},"generated":{"line":1,"column":3320}},{"source":"sandbox.js","original":{"line":157,"column":15},"generated":{"line":1,"column":3324}},{"source":"sandbox.js","name":"env","original":{"line":157,"column":20},"generated":{"line":1,"column":3329}},{"source":"sandbox.js","original":{"line":159,"column":8},"generated":{"line":1,"column":3335}},{"source":"sandbox.js","original":{"line":160,"column":11},"generated":{"line":1,"column":3341}},{"source":"sandbox.js","original":{"line":160,"column":11},"generated":{"line":1,"column":3345}},{"source":"sandbox.js","name":"syscalls","original":{"line":161,"column":13},"generated":{"line":1,"column":3355}},{"source":"sandbox.js","name":"syscalls","original":{"line":161,"column":13},"generated":{"line":1,"column":3360}},{"source":"sandbox.js","name":"evt","original":{"line":161,"column":22},"generated":{"line":1,"column":3369}},{"source":"sandbox.js","name":"name","original":{"line":161,"column":26},"generated":{"line":1,"column":3371}},{"source":"sandbox.js","name":"evt","original":{"line":161,"column":32},"generated":{"line":1,"column":3377}},{"source":"sandbox.js","name":"arg","original":{"line":161,"column":36},"generated":{"line":1,"column":3379}},{"source":"sandbox.js","original":{"line":161,"column":41},"generated":{"line":1,"column":3383}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3394}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3398}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3402}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3404}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3414}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3421}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3423}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3427}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3433}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3436}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3438}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3440}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3442}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3444}},{"source":"sandbox.js","name":"args","original":{"line":161,"column":45},"generated":{"line":1,"column":3448}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3450}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3453}},{"source":"sandbox.js","original":{"line":161,"column":54},"generated":{"line":1,"column":3463}},{"source":"sandbox.js","original":{"line":162,"column":10},"generated":{"line":1,"column":3466}},{"source":"sandbox.js","name":"post","original":{"line":162,"column":15},"generated":{"line":1,"column":3468}},{"source":"sandbox.js","original":{"line":162,"column":20},"generated":{"line":1,"column":3473}},{"source":"sandbox.js","name":"type","original":{"line":163,"column":12},"generated":{"line":1,"column":3474}},{"source":"sandbox.js","original":{"line":163,"column":18},"generated":{"line":1,"column":3479}},{"source":"sandbox.js","name":"id","original":{"line":164,"column":12},"generated":{"line":1,"column":3497}},{"source":"sandbox.js","name":"evt","original":{"line":164,"column":16},"generated":{"line":1,"column":3500}},{"source":"sandbox.js","name":"id","original":{"line":164,"column":20},"generated":{"line":1,"column":3502}},{"source":"sandbox.js","name":"args","original":{"line":165,"column":12},"generated":{"line":1,"column":3505}},{"source":"sandbox.js","name":"args","original":{"line":165,"column":12},"generated":{"line":1,"column":3510}},{"source":"sandbox.js","original":{"line":170,"column":24},"generated":{"line":1,"column":3516}},{"source":"sandbox.js","name":"evt","original":{"line":170,"column":11},"generated":{"line":1,"column":3530}},{"source":"sandbox.js","name":"name","original":{"line":170,"column":15},"generated":{"line":1,"column":3532}},{"source":"sandbox.js","name":"cleanup","original":{"line":171,"column":15},"generated":{"line":1,"column":3538}},{"source":"sandbox.js","name":"cleanup","original":{"line":171,"column":15},"generated":{"line":1,"column":3543}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3556}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3557}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3561}},{"source":"sandbox.js","original":{"line":177,"column":2},"generated":{"line":1,"column":3571}},{"source":"sandbox.js","original":{"line":177,"column":2},"generated":{"line":1,"column":3577}},{"source":"sandbox.js","name":"document","original":{"line":178,"column":4},"generated":{"line":1,"column":3588}},{"source":"sandbox.js","name":"body","original":{"line":178,"column":13},"generated":{"line":1,"column":3597}},{"source":"sandbox.js","name":"removeChild","original":{"line":178,"column":18},"generated":{"line":1,"column":3602}},{"source":"sandbox.js","original":{"line":178,"column":30},"generated":{"line":1,"column":3614}},{"source":"sandbox.js","name":"iframe","original":{"line":178,"column":35},"generated":{"line":1,"column":3619}},{"source":"sandbox.js","name":"listeners","original":{"line":179,"column":9},"generated":{"line":1,"column":3627}},{"source":"sandbox.js","name":"listeners","original":{"line":179,"column":9},"generated":{"line":1,"column":3632}},{"source":"sandbox.js","name":"forEach","original":{"line":179,"column":19},"generated":{"line":1,"column":3642}},{"source":"sandbox.js","original":{"line":179,"column":27},"generated":{"line":1,"column":3650}},{"source":"sandbox.js","name":"fn","original":{"line":179,"column":27},"generated":{"line":1,"column":3659}},{"source":"sandbox.js","name":"window","original":{"line":179,"column":33},"generated":{"line":1,"column":3662}},{"source":"sandbox.js","name":"window","original":{"line":179,"column":33},"generated":{"line":1,"column":3669}},{"source":"sandbox.js","name":"removeEventListener","original":{"line":179,"column":40},"generated":{"line":1,"column":3676}},{"source":"sandbox.js","original":{"line":179,"column":60},"generated":{"line":1,"column":3696}},{"source":"sandbox.js","name":"fn","original":{"line":179,"column":71},"generated":{"line":1,"column":3706}},{"source":"sandbox.js","name":"listeners","original":{"line":180,"column":9},"generated":{"line":1,"column":3711}},{"source":"sandbox.js","name":"listeners","original":{"line":180,"column":9},"generated":{"line":1,"column":3716}},{"source":"sandbox.js","original":{"line":180,"column":21},"generated":{"line":1,"column":3726}},{"source":"sandbox.js","original":{"line":184,"column":0},"generated":{"line":1,"column":3733}},{"source":"sandbox.js","name":"ProcessSandbox","original":{"line":112,"column":6},"generated":{"line":1,"column":3735}},{"source":"sandbox.js","name":"window","original":{"line":184,"column":0},"generated":{"line":1,"column":3738}},{"source":"sandbox.js","name":"runInSandbox","original":{"line":184,"column":7},"generated":{"line":1,"column":3745}},{"source":"sandbox.js","original":{"line":184,"column":22},"generated":{"line":1,"column":3758}},{"source":"sandbox.js","name":"source","original":{"line":184,"column":31},"generated":{"line":1,"column":3767}},{"source":"sandbox.js","name":"syscalls","original":{"line":184,"column":39},"generated":{"line":1,"column":3769}},{"source":"sandbox.js","name":"args","original":{"line":184,"column":49},"generated":{"line":1,"column":3771}},{"source":"sandbox.js","name":"env","original":{"line":184,"column":55},"generated":{"line":1,"column":3773}},{"source":"sandbox.js","name":"ProcessSandbox","original":{"line":185,"column":6},"generated":{"line":1,"column":3776}},{"source":"sandbox.js","name":"ProcessSandbox","original":{"line":185,"column":6},"generated":{"line":1,"column":3780}},{"source":"sandbox.js","name":"source","original":{"line":185,"column":21},"generated":{"line":1,"column":3782}},{"source":"sandbox.js","name":"syscalls","original":{"line":185,"column":29},"generated":{"line":1,"column":3784}},{"source":"sandbox.js","name":"args","original":{"line":185,"column":39},"generated":{"line":1,"column":3786}},{"source":"sandbox.js","name":"env","original":{"line":185,"column":45},"generated":{"line":1,"column":3788}}],"sources":{"sandbox.js":"/* Message types:\n-- outgoing --\n ready\n  data: null\n syscall\n  data: {\n    name: name of the syscall\n    id: uuid //or incremented\n    arg: the one singular arg\n  }\n\n-- incoming --\n script:\n  data: {\n    type: 'script',\n    source: 'src'\n    syscallNames: ['name1', 'name2', 'etc'],\n    args: ['arg1', 'arg2', 'etc'],\n    env: {envObj},\n  }\n syscallResponse\n  data: {\n    id: uuid // or incremented\n    args: [array, of, args],\n  }\n*/\n\n\nconst sandboxText = iframeId => `\n<!DOCTYPE html>\n<html>\n  <head>\n    <script>\n      function runScript(source, syscalls, args, env){\n        eval(source);\n      };\n\n      (function(){\n        let scriptContents = null;\n        let id = 30000;\n        let syscalls;\n\n        const syscallCBs = {};\n\n        function makeSyscall(name, arg, cb){\n          syscallCBs[id] = cb;\n          post({type: 'syscall', name, arg, id });\n          id++;\n        }\n\n        function handleSyscallResponse(id, args){\n          try {\n            syscallCBs[id] && syscallCBs[id](...args);\n          } catch (e) {\n            syscalls.write({ fd: 2, data: e.message + '\\\\n' });\n            syscalls.terminate(1);\n          }\n        }\n\n        function syscallsFromNames(syscallNames){\n          return syscallNames.reduce((acc, name) => {\n            acc[name] = (arg, cb) => makeSyscall(name, arg, cb)\n            return acc;\n          }, {});\n        }\n\n        function loadScript(source, syscallNames, args, env){\n          syscalls = syscallsFromNames(syscallNames);\n          try {\n            runScript(source, syscalls, args, env);\n          } catch (e) {\n            syscalls.write({ fd: 2, data: e.message + '\\\\n' });\n            syscalls.terminate(1);\n          }\n        }\n\n        function receiveMessage(msg){\n          switch(msg.type){\n            case 'script':\n              loadScript(msg.source, msg.syscallNames, msg.args, msg.env);\n              break;\n            case 'syscallResponse':\n              handleSyscallResponse(msg.id, msg.args)\n              break;\n          }\n        }\n\n        function post(msg){\n          window.parent.postMessage(JSON.stringify({ msg, iframeId: ${JSON.stringify(iframeId)}}), '*');\n        }\n\n        function listen(fn) {\n          const recv = evt => fn(JSON.parse(evt.data));\n          window.addEventListener(\"message\", recv, false);\n        }\n\n        document.addEventListener('DOMContentLoaded', () => {\n          listen(receiveMessage);\n          post({ type: 'ready' });\n        });\n      })();\n\n    </script>\n  </head>\n</html>\n`;\n\nlet iframeId = 2000;\n\nconst dataUrl = data => \"data:text/html;base64,\" + btoa(data);\n\nclass ProcessSandbox {\n  constructor(source, syscalls, args, env){\n    this.source = source;\n    this.syscalls = syscalls;\n    this.args = args;\n    this.env = env;\n\n    // wow this is garbage.\n    this.iframeId = iframeId;\n    iframeId++;\n\n    // initialization of the iframe\n    const iframe = document.createElement('iframe');\n    this.iframe = iframe;\n\n    document.body.appendChild(iframe);\n    iframe.sandbox = 'allow-scripts';\n    iframe.src = dataUrl(sandboxText(this.iframeId));\n    this.listeners = [];\n    this.listen(this.handleEvent.bind(this));\n  }\n\n  post(msg){\n    this.iframe.contentWindow.postMessage(JSON.stringify(msg), '*');\n  }\n\n  listen(fn) {\n    const recv = evt => {\n      if(evt.source === this.iframe.contentWindow) {\n        const { msg } = JSON.parse(evt.data);\n        fn(msg);\n      }\n    }\n    window.addEventListener(\"message\", recv, false);\n    this.listeners.push(recv);\n  }\n\n  handleEvent(evt){\n    switch(evt.type){\n      case 'ready':\n        this.post({\n          type: 'script',\n          source: this.source,\n          syscallNames: Object.keys(this.syscalls),\n          args: this.args,\n          env: this.env\n        });\n        break;\n      case 'syscall':\n        this.syscalls[evt.name](evt.arg, (...args) => {\n          this.post({\n            type: 'syscallResponse',\n            id: evt.id,\n            args,\n          });\n        });\n\n        // special case for the terminate case... a little weird to put it here but whatevs.\n        if(evt.name === 'terminate'){\n          this.cleanup();\n        }\n        break;\n    }\n  }\n\n  cleanup(){\n    document.body.removeChild(this.iframe);\n    this.listeners.forEach(fn => window.removeEventListener('message', fn));\n    this.listeners = [];\n  }\n};\n\nwindow.runInSandbox = function(source, syscalls, args, env) {\n  new ProcessSandbox(source, syscalls, args, env);\n}"},"lineCount":null}},"error":null,"hash":"f08cbe52ad87fb99506e560e6fa0e2dc","cacheData":{"env":{}}}